---
- name: end-to-end run
  ansible.builtin.shell: |
    set -euxo pipefail
    source {{ role_path }}/files/system.sh \
      {{ node_prefix }} \
      {{ network_interface }} \
      {{ mysql_password }} \
      {{ virtual_ip_address }}
    initialize_nodes
    superset_node_address=$(superset_node_address)
    docker_swarm_token=$(docker_swarm_token "${superset_node_address}")
    clusterize_nodes
    start_superset
    sleep 60
  args:
    executable: /bin/bash
  register: end_to_end_output

- name: Display the output
  ansible.builtin.debug:
    var: end_to_end_output.stdout
