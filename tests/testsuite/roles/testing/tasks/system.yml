---
- name: end-to-end run
  ansible.builtin.shell: |
    set -euxo pipefail
    source {{ role_path }}/files/system.sh \
      {{ node_prefix }} \
      {{ superset_network_interface }} \
      {{ mysql_password }} \
      {{ virtual_ip_address }} \
      {{ virtual_network_interface }}
    initialize_nodes
    superset_node_address=$(superset_node_address)
    docker_swarm_token=$(docker_swarm_token "${superset_node_address}")
    clusterize_nodes
    start_superset
    sleep 60
  args:
    executable: /bin/bash
